services:
  #Define the services for the Node.js app
  backend:
    image: expense-tracker-backend
    build: #Build an image 
      context: ../    #Start from the root directory
      dockerfile: docker/backend.dockerfile #Locate the dockerfile to build
    container_name: backend
    ports:
      - "4000:4000"
    volumes:
      - ../:/app  #Map the source code from the root directory
    environment:
      - NODE_ENV=development
      - MONGO_HOST=mongo
      - MONGO_PORT=27017
    networks:
      - expense-tracker-network
    depends_on:
      - mongo #Ensures the 'mongo' service is started before the app service

  mongo:
    image: mongo:latest
    container_name: mongo
    ports:
      - "27017:27017"
    networks:
      - expense-tracker-network

networks:
  expense-tracker-network   #Docket creates a network (with deafult driver: bridge) if it doesn't exist 